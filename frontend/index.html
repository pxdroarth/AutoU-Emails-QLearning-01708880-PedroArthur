<!DOCTYPE html>
<!--
Nome do arquivo: index.html
Data de criação: 17/09/2025
Autor: Pedro Arthur Maia Damasceno
Matrícula: 01708880

Descrição:
Página principal do frontend do AutoU — Classificador & Auto-Responder.
UI para colar/selecionar e-mails, acionar classificação, enviar feedback humano,
disparar treino e visualizar métricas.

Funcionalidades:
- Entrada de texto e upload de arquivo (.txt, .pdf, .eml)
- Ação de "Processar" para classificar via API
- Exibição de categoria, confiança e resposta sugerida
- Fluxo de feedback (correto/errado) com correção de classe
- Botões para treinar o agente e consultar métricas
- Toast simples para feedback visual
-->

<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>AutoU — Classificador de Emails</title>

  <!-- Estilos -->
  <link rel="stylesheet" href="./styles.css"/>

  <!-- Favicon -->
  <link rel="icon" href="./favicon.ico" sizes="any">
  <meta name="theme-color" content="#1b1b1f">

  <!-- Evita zoom de double-tap em mobile para botões -->
  <meta name="touch-action" content="manipulation">
</head>
<body>
  <noscript>Ative o JavaScript para usar o AutoU.</noscript>

  <main class="container" role="main">
    <h1>
      AutoU — Classificador &amp; Auto-Responder
      <span id="originTitle" class="muted" aria-live="polite"></span>
    </h1>

    <!-- Entrada -->
    <section class="card" aria-labelledby="sec-input-title">
      <h2 id="sec-input-title" class="sr-only">Entrada</h2>

      <label for="emailText">Colar texto do email</label>
      <textarea id="emailText" rows="8" placeholder="Cole aqui o conteúdo do email..." spellcheck="false"></textarea>

      <div class="row">
        <div>
          <label for="emailFile">Ou enviar arquivo (.txt, .pdf, .eml)</label>
          <input id="emailFile" type="file" accept=".txt,.pdf,.eml"/>
        </div>

        <div class="actions">
          <button id="btnProcessar" type="button" aria-label="Processar texto/arquivo">Processar</button>
        </div>
      </div>

      <small class="muted">Processamento com fallback inteligente (HF → modelo → heurística).</small>
    </section>

    <!-- Resultado -->
    <section id="result" class="card hidden" aria-labelledby="sec-result-title">
      <h2 id="sec-result-title">Resultado</h2>

      <p>
        <strong>Categoria:</strong>
        <span id="outCategory" aria-live="polite">-</span>
        <span id="originBadge" class="badge" title="Origem da classificação">?</span>
      </p>

      <p><strong>Confiança:</strong> <span id="outConfidence" aria-live="polite">-</span></p>

      <label for="outReply">Resposta sugerida</label>
      <textarea id="outReply" rows="6" readonly></textarea>

      <button id="btnCopiar" type="button">Copiar resposta</button>
    </section>

    <!-- Revisão manual (feedback humano) -->
    <section id="feedback-section" class="card hidden" aria-labelledby="sec-feedback-title">
      <h2 id="sec-feedback-title">Revisão manual</h2>
      <p>Essa classificação está correta?</p>

      <div class="feedback-actions">
        <button id="btnCorreto" class="btn ok" type="button">Correto</button>
        <button id="btnErrado" class="btn err" type="button">Errado</button>

        <div id="correcao-wrap" class="hidden">
          <label for="selectCorrecao" class="sr-only">Corrigir para</label>
          <select id="selectCorrecao" class="select">
            <option value="">Corrigir para...</option>
            <option value="produtivo">Produtivo</option>
            <option value="improdutivo">Improdutivo</option>
          </select>
          <button id="btnEnviarCorrecao" class="btn warn" type="button">Enviar correção</button>
        </div>
      </div>

      <div class="feedback-train">
        <button id="btnTreinar" class="btn" type="button">Treinar agora</button>
      </div>

      <pre id="metricasBox" class="metrics hidden" aria-live="polite"></pre>
    </section>

    <!-- Toast -->
    <div id="toast" class="toast hidden" role="status" aria-live="polite"></div>

    <footer class="muted center">Feito por Pedro Arthur — Case Prático PROVA do CHICO</footer>
  </main>

  <!-- Configuração da API (opcionalmente injetado pelo servidor) -->
  <script>window.API_BASE = "http://127.0.0.1:8000";</script>

  <!-- Prevenir qualquer submit acidental de formulário (não usamos forms) -->
  <script>
    document.addEventListener('submit', (e) => e.preventDefault());
  </script>

  <!-- Ordem correta: config primeiro, depois app -->
  <script src="./config.js?v=11"></script>
  <script src="./app.js?v=11"></script>
</body>
</html>
